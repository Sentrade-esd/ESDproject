# Start from the latest Kong image
FROM kong:latest

# Install the Prometheus plugin
USER root
RUN luarocks install kong-prometheus-plugin
# RUN apt install curl -y

# Switch back to the Kong user
USER kong

# Copy the kong.yml file into the image
COPY kong.yml /etc/kong/kong.yml

# # Set the necessary environment variables
ENV KONG_DATABASE=off 
ENV KONG_DECLARATIVE_CONFIG=/etc/kong/kong.yml

EXPOSE 8000 8443 8001 8444